<% if flash[:add_todo] %>
  <div class="alert alert-success">
    <%= flash[:add_todo] %>
  </div>
<% end %>
<% if flash[:miss_add_todo] %>
  <div class="alert alert-danger">
    <%= flash[:miss_add_todo] %>
  </div>
<% end %>
<% if flash[:success_todo_update] %>
  <div class="alert alert-success">
    <%= flash[:success_todo_update] %>
  </div>
<% end %>
<% if flash[:success_update] %>
  <div class="alert alert-info">
    <%= flash[:success_update] %>
  </div>
<% end %>

<div class="todo-index contaiber">
  <div class="row">
  	<div class="col-md-8">
  	  <h3>ToDoの追加</h3>
      <%= form_with(model: @todolist, url: todolists_path, local: true) do |t| %>
        <label class="new-todo-body" for="">やる事</label>
        <%= t.text_area :body, class: 'form-control', style: "height: 100px;" %>
        <label class="new-todo-deadtime" for="">目標期限</label><br>
         <%= t.date_field :deadline, min: Date.today, max: Date.today+100, style: "width: 150px;" %>
        <div class="new-todo-create"><%= t.submit 'リストに追加', class: "btn btn-warning", style: "width: 150px;" %></div>
      <% end %>
  	</div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <h3>ToDoList一覧</h3>
      <div class="form-group">
        <%= form_with(url: todolists_path, method: :get, local: true, class: "form-inline") do |f| %>
          <label class="todo_button"><%= radio_button_tag( "todo_status", 1) %>挑戦中</label>
          <label class="todo_button"><%= radio_button_tag( "todo_status", 2) %>達成</label>
          <label class="todo_button"><%= radio_button_tag( "todo_status", 3) %>未達</label>
          <label class="todo_button"><%= radio_button_tag( "todo_status", 4) %>全てのリスト</label>
          <%= f.submit "表示を変更する", class: "btn btn-primary btn-mg" %>
        <% end %>
      </div>
	  <table class="table table-hover" style="table-layout:fixed;width:100%;">
	  	<colgroup>
	  	  <col style="width:13%;">
          <col style="width:60%;">
          <col style="width:12%;">
          <col style="width:10%;">
        </colgroup>
	    <thead>
	      <tr>
	      	<th>目標期限</th>
            <th>内容</th>
            <th>ステータス</th>
            <th>その他</th>
	      </tr>
	    </thead>
	    <tbody style="word-wrap:break-word;">
	      <% @todolists.each do |list| %>
		    <tr>
		      <% if list.status == "challenge" %>
		        <th>
			      <h4><%= list.deadline.strftime("%Y-%m-%d") %></h4>
			    </th>
			    <th>
			      <h4><%= list.body %></h4>
			    </th>
			    <th>
			      <h4>
			      	期限まで後<%= current_user.ckeck_date(list) %>日
			        <br><br>
			        <%= link_to '達成！', todolist_congratulations_path(list), method: :patch, :class =>"btn btn-primary" %>
			      </h4>
			    </th>
			    <th>
                  <%= link_to "編集", edit_todolist_path(list.id), :class =>"btn btn-success" %>
                  <br><br>
                  <%= link_to "削除", todolist_path(list.id), method: :delete, data: {confirm: 'Todoリストから削除しますか？'}, :class =>"btn btn-danger" %>
			    </th>
			  <% elsif list.status == "complete" %>
			    <th><h4><%= list.deadline.strftime("%Y-%m-%d") %></h4></th>
			    <th><h4><%= list.body %></h4></th>
			    <th><h4>達成</h4></th>
			    <th><h4 class="glyphicon glyphicon-thumbs-up" aria-hidden="true" style="color:blue;"></h4></th>
			  <% elsif list.status == "unachieved" %>
			  	<th><h4><%= list.deadline.strftime("%Y-%m-%d") %></h4></th>
			    <th><h4><%= list.body %></h4></th>
			    <th><h5>未達</h5></th>
			    <th><h5 class="glyphicon glyphicon-warning-sign" aria-hidden="true"></h5></th>
	          <% else %>
	          <% end %>
			</tr>
		  <% end %>
		</tbody>
	  </table>
	  <div class="page_center">
	    <%= paginate @todolists %>
	  </div>
	</div>
  </div>
</div>


